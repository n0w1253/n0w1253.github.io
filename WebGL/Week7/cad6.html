<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <link rel="stylesheet" type="text/css" href="tabs.css"/>
        <link rel="stylesheet" type="text/css" href="../lib/dhtmlxSlider/dhtmlxslider.css"/>
        <link rel="stylesheet" href="switch.css">
        <script type="text/javascript" src="../lib/dhtmlxSlider/dhtmlxslider.js">
        </script>
        <style>
            
            #gl-canvas {
                height: 520px;
                width: 520px;
                float: left;
                padding: 5px;
            }
            
            .sliderObj {
                position: relative;
                margin-top: 5px;
                width: 150px;
                height: 15px;
            }
            
            .field {
                position: relative;
                margin-left: 0px;
                margin-top: 5px;
                border: 1px;
                border-style: solid;
                border-color: #3C8FC7;
                width: 30px;
                height: 15px;
            }
            
            .option {
                position: relative;
                font-family: "Gudea";
                font-size: 14px;
                color: #525252;
                margin-top: 5px;
                width: 170px;
                border: 1px;
                border-style: solid;
                border-color: #3C8FC7;
            }
        </style>
        <script id="vertex-shader" type="x-shader/x-vertex">
            attribute vec4 vPosition;
            attribute vec4 vNormal;
            varying vec3 N, L, E;
            varying vec3 N2, L2, E2;
            uniform mat4 modelViewMatrix;
            uniform mat4 projectionMatrix;
            uniform vec4 lightPosition;
            uniform vec4 lightPosition2;
            //uniform mat3 normalMatrix;
            uniform vec4 eyePosition;
            void main()
            {
            // vec3 light;
            //vec3 pos = (modelViewMatrix * vPosition).xyz;
            vec3 light = lightPosition.xyz;
            vec3 pos = (projectionMatrix * modelViewMatrix * vPosition).xyz;
            vec3 light2 = lightPosition2.xyz;
            // if(lightPosition.z == 0.0)  L = normalize(lightPosition.xyz);
            //  else  L = normalize(lightPosition).xyz - pos;
            L = normalize(light - pos);
            L2 = normalize(light2 - pos);
            //   E =  -normalize(pos);
            E = normalize(eyePosition.xyz - pos);
            E2 = E;
            //   N = normalize( normalMatrix*vNormal.xyz);
            N = normalize( modelViewMatrix * vNormal).xyz;
            N2=N;
            gl_Position = projectionMatrix * modelViewMatrix * vPosition;
            }
        </script>
        <script id="fragment-shader" type="x-shader/x-fragment">
            precision mediump float;
            uniform vec4 ambientProduct;
            uniform vec4 diffuseProduct;
            uniform vec4 specularProduct; 
            uniform float shininess; 
            uniform bool uUseLight1;
            uniform bool uUseLight2; 
            varying vec3 N, L, E; 
            varying vec3 N2, L2, E2;  
            void main() 
            { 
            vec4 fColor;
			vec4 ambient = ambientProduct;
			fColor = ambient;
			
            if (uUseLight1) {
            vec3 H = normalize( L + E );
            float Kd = max( dot(L, N), 0.0 );
            vec4  diffuse = Kd*diffuseProduct;
            float Ks = pow( max(dot(N, H), 0.0), shininess ); 
            vec4  specular = Ks * specularProduct; 
            if( dot(L, N) < 0.0 ) specular = vec4(0.0, 0.0, 0.0, 1.0); 
			fColor = fColor + diffuse +specular;
            }
			
			if (uUseLight2) {
            vec3 H2 = normalize( L2 + E2 );           
            float Kd2 = max( dot(L2, N2), 0.0 );
            vec4  diffuse2 = Kd2*diffuseProduct;
            float Ks2 = pow( max(dot(N2, H2), 0.0), shininess );  
            vec4  specular2 = Ks2 * specularProduct;  
            if( dot(L2, N2) < 0.0 ) specular2 = vec4(0.0, 0.0, 0.0, 1.0);
            fColor = fColor +diffuse2 +specular2;
			}
            fColor.a = 1.0;
            gl_FragColor = fColor;
            }
        </script>
        <script type="text/javascript" src="../Common/webgl-utils.js">
        </script>
        <script type="text/javascript" src="../Common/initShaders.js">
        </script>
        <script type="text/javascript" src="../Common/MV.js">
        </script>
        <script type="text/javascript" src="cad6.js">
        </script>
        <script type="text/javascript" src=../lib/jquery.js>
        </script>
        <script type="text/javascript" src=../lib/FileSaver.js>
        </script>
        <script type="text/javascript" src="../lib/jscolor/jscolor.js">
        </script>
    </head>
    <body onload="doOnLoad();init();">
        <div>
            <canvas id="gl-canvas" width="512" height="512" style="border:1px solid #000000;">
                Oops ... your browser doesn't support the HTML5 canvas element
            </canvas>
        </div>
        <div class="tabs">
            <ul class="tab-links">
                <li class="active">
                    <a href="#tab1" id ="tab1">Lights</a>
                </li>
                <li>
                    <a href="#tab2">Objects</a>
                </li>
            </ul>
            <div class="tab-content">
                <div id="tab1" class="tab active">
                    <table cellspacing="0" cellpadding="0" border="0">
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;font-weight: 600;">
                                Moving Light 1
                            </td>
                            <td style="padding-left:10px;">
                                <label class="switch">
                                    <input id="light1CB" type="checkbox" class="switch-input" onclick='handleL1Click(this);'><span class="switch-label" data-on="On" data-off="Off"></span>
                                    <span class="switch-handle"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Position
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                X
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL1Px" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL1Px">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Y
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL1Py" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL1Py">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Z
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL1Pz" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL1Pz">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetL1Position()">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Distance
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                From Origin
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL1Dist" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL1Dist">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetL1Distance()">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <br/>
                                <br/>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;font-weight: 600;">
                                Moving Light 2
                            </td>
                            <td style="padding-left:10px;">
                                <label class="switch">
                                    <input id="light2CB" type="checkbox" class="switch-input" onclick='handleL2Click(this);'><span class="switch-label" data-on="On" data-off="Off"></span>
                                    <span class="switch-handle"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Position
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                X
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL2Px" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL2Px">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Y
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL2Py" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL2Py">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Z
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL2Pz" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL2Pz">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetL2Position()">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Distance
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                From Origin
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjL2Dist" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpL2Dist">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetL2Distance()">
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="tab2" class="tab">
                    <table cellspacing="0" cellpadding="0" border="0">
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Shape
                            </td>
                            <td style="padding-left:10px;">
                                <select id="Controls" class="option" size="3">
                                    <option value="0" selected>Sphere</option>
                                    <option value="1">Cone</option>
                                    <option value="2">Cylindar</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:10px;padding-left:10px;">
                                Scale
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                X
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjSx" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpSx">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Y
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjSy" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpSy">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Z
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjSz" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpSz">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetScale()">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Rotation
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                X
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjRx" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpRx">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Y
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjRy" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpRy">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Z
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjRz" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpRz">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetRotation()">
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;">
                                Position
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                X
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjPx" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpPx">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Y
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjPy" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpPy">
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" style="padding-top:5px;padding-left:10px;text-align:center;">
                                Z
                            </td>
                            <td style="padding-left:10px;">
                                <div id="sliderObjPz" class="sliderObj">
                                </div>
                            </td>
                            <td>
                                <input type="text" class="field" id="inpPz">
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                            </td>
                            <td valign="top" style="padding-top:5px;text-align:left;">
                                <div>
                                    <input class="button" type="button" value="Reset" onClick="resetPosition()">
                                </div>
                            </td>
                        </tr>
                    </table>
                    <table cellspacing="0" cellpadding="0" border="0">
                        <tr>
                            <td valign="top" style="padding-top:25px;padding-left:10px;">
                                <div>
                                    <input class="button" type="button" value="ADD" onClick="addObj()">
                                </div>
                            </td>
                            <td valign="top" style="padding-top:25px;padding-left:10px;">
                                <div>
                                    <input class="button" type="button" value="UNDO" onClick="removeLastObj()">
                                </div>
                            </td>
                            <td valign="top" style="padding-top:25px;padding-left:10px;">
                                <div>
                                    <input class="button" type="button" value="CLEAR" onClick="removeAllObj()">
                                </div>
                            </td>
                            <td valign="top" style="padding-top:25px;padding-left:35px;">
                                <div>
                                    <input class="button" type="button" value="SAVE" onClick="saveToFile()">
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <script>
            var mySliderSx, mySliderSy, mySliderSz, mySliderRx, mySliderRy, mySliderRz, mySliderPx, mySliderPy, mySliderPz, mySliderL1Px, mySliderL1Py, mySliderL1Pz, mySliderL1Dist, mySliderL2Px, mySliderL2Py, mySliderL2Pz, mySliderL2Dist;
            
            function doOnLoad(){
            
                mySliderSx = new dhtmlXSlider({
                    parent: "sliderObjSx",
                    step: 0.1,
                    min: 0.1,
                    max: 2,
                    value: 1,
                    linkTo: "inpSx",
                });
                mySliderSy = new dhtmlXSlider({
                    parent: "sliderObjSy",
                    step: 0.1,
                    min: 0.1,
                    max: 2,
                    value: 1,
                    linkTo: "inpSy",
                });
                mySliderSz = new dhtmlXSlider({
                    parent: "sliderObjSz",
                    step: 0.1,
                    min: 0.1,
                    max: 2,
                    value: 1,
                    linkTo: "inpSz",
                });
                
                mySliderRx = new dhtmlXSlider({
                    parent: "sliderObjRx",
                    step: 1,
                    min: -180,
                    max: 180,
                    value: 0,
                    linkTo: "inpRx",
                });
                mySliderRy = new dhtmlXSlider({
                    parent: "sliderObjRy",
                    step: 1,
                    min: -180,
                    max: 180,
                    value: 0,
                    linkTo: "inpRy",
                });
                mySliderRz = new dhtmlXSlider({
                    parent: "sliderObjRz",
                    step: 1,
                    min: -180,
                    max: 180,
                    value: 0,
                    linkTo: "inpRz",
                });
                
                mySliderPx = new dhtmlXSlider({
                    parent: "sliderObjPx",
                    step: 0.1,
                    min: -1,
                    max: 1,
                    value: 0,
                    linkTo: "inpPx",
                });
                mySliderPy = new dhtmlXSlider({
                    parent: "sliderObjPy",
                    step: 0.1,
                    min: -1,
                    max: 1,
                    value: 0,
                    linkTo: "inpPy",
                });
                mySliderPz = new dhtmlXSlider({
                    parent: "sliderObjPz",
                    step: 0.1,
                    min: -2,
                    max: 2,
                    value: 0,
                    linkTo: "inpPz",
                });
                
                mySliderL1Px = new dhtmlXSlider({
                    parent: "sliderObjL1Px",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL1Px",
                });
                mySliderL1Py = new dhtmlXSlider({
                    parent: "sliderObjL1Py",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL1Py",
                });
                mySliderL1Pz = new dhtmlXSlider({
                    parent: "sliderObjL1Pz",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL1Pz",
                });
                mySliderL1Dist = new dhtmlXSlider({
                    parent: "sliderObjL1Dist",
                    step: 1,
                    min: 0,
                    max: 34,
                    value: 15,
                    linkTo: "inpL1Dist",
                });
                mySliderL2Px = new dhtmlXSlider({
                    parent: "sliderObjL2Px",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL2Px",
                });
                mySliderL2Py = new dhtmlXSlider({
                    parent: "sliderObjL2Py",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL2Py",
                });
                mySliderL2Pz = new dhtmlXSlider({
                    parent: "sliderObjL2Pz",
                    step: 1,
                    min: 0,
                    max: 20,
                    value: 10,
                    linkTo: "inpL2Pz",
                });
                mySliderL2Dist = new dhtmlXSlider({
                    parent: "sliderObjL2Dist",
                    step: 1,
                    min: 0,
                    max: 34,
                    value: 15,
                    linkTo: "inpL2Dist",
                });
                
                mySliderSx.attachEvent("onChange", function(pos, slider){
                    window.inpSx = mySliderSx.getValue();
                });
                mySliderSy.attachEvent("onChange", function(pos, slider){
                    window.inpSy = mySliderSy.getValue();
                });
                mySliderSz.attachEvent("onChange", function(pos, slider){
                    window.inpSz = mySliderSz.getValue();
                });
                
                mySliderRx.attachEvent("onChange", function(pos, slider){
                    window.inpRx = mySliderRx.getValue();
                });
                mySliderRy.attachEvent("onChange", function(pos, slider){
                    window.inpRy = mySliderRy.getValue();
                });
                mySliderRz.attachEvent("onChange", function(pos, slider){
                    window.inpRz = mySliderRz.getValue();
                });
                
                mySliderPx.attachEvent("onChange", function(pos, slider){
                    window.inpPx = mySliderPx.getValue();
                });
                mySliderPy.attachEvent("onChange", function(pos, slider){
                    window.inpPy = mySliderPy.getValue();
                });
                mySliderPz.attachEvent("onChange", function(pos, slider){
                    window.inpPz = mySliderPz.getValue();
                });
                
                
            };
            
            
            
            $(".field").on('input', function(){
                setCadValues();
            });
            
            $(".option").change(function(){
                window.inpShape = $(this).children("option:selected").index();
                
            });
            
            jQuery('.tabs .tab-links a').on('click', function(e){
                var currentAttrValue = jQuery(this).attr('href');
                
                // Show/Hide Tabs
                jQuery('.tabs ' + currentAttrValue).show().siblings().hide();
                
                // Change/remove current tab to active
                jQuery(this).parent('li').addClass('active').siblings().removeClass('active');
                
                e.preventDefault();
            });
            
            
            
            function resetScale(){
                mySliderSx.setValue(1);
                mySliderSy.setValue(1);
                mySliderSz.setValue(1);
                setCadValues();
            }
            
            function resetRotation(){
                mySliderRx.setValue(0);
                mySliderRy.setValue(0);
                mySliderRz.setValue(0);
                setCadValues();
            }
            
            function resetPosition(){
                mySliderPx.setValue(0);
                mySliderPy.setValue(0);
                mySliderPz.setValue(0);
                setCadValues();
            }
            
            function setCadValues(){
                window.inpSx = $("#inpSx").val();
                window.inpSy = $("#inpSy").val();
                window.inpSz = $("#inpSz").val();
                window.inpRx = $("#inpRx").val();
                window.inpRy = $("#inpRy").val();
                window.inpRz = $("#inpRz").val();
                window.inpPx = $("#inpPx").val();
                window.inpPy = $("#inpPy").val();
                window.inpPz = $("#inpPz").val();
            }
            
            function handleL1Click(cb){
                window.useLight1 = cb.checked;
            }
			
			function handleL2Click(cb){
                window.useLight2 = cb.checked;
            }
        </script>
    </body>
</html>
